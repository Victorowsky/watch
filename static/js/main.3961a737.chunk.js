(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{121:function(e,t,n){},125:function(e,t,n){},132:function(e,t,n){},133:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(15),o=n.n(c),i=(n(90),n(8)),s=n(5),u=n(75),l=n.n(u),m=(n(121),n(163)),d=n(165),f=Object(m.a)((function(e){return{root:{"& > *":{margin:e.spacing(1),borderColor:"white",color:"white",transition:"0.3s","&:hover":{color:"red",borderColor:"red"}}}}}));function E(e){var t=e.text,n=e.onClick,a=e.style,c=f();return r.a.createElement("div",{className:c.root},r.a.createElement(d.a,{onClick:n&&n,style:a&&a,variant:"outlined"},t||"Enter text"))}n(125);var b=function(){var e=Object(a.useContext)(x),t=e.admin,n=(e.setAdmin,e.setCurrentVideoLink),c=e.socket,o=e.setTwitchStreamerChat,s=Object(a.useState)(),u=Object(i.a)(s,2),l=u[0],m=u[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null),t&&r.a.createElement("form",null,r.a.createElement("input",{type:"text",value:l,placeholder:"VIDEO URL",onChange:function(e){t&&m(e.target.value)}}),r.a.createElement("button",{style:{display:"none"},onClick:function(e){e.preventDefault(),n(l),m("")},type:"submit"})),r.a.createElement("div",{className:"adminButtonsDiv"},r.a.createElement(E,{text:"CHANGE STREAMER'S CHAT",onClick:function(){var e=prompt("Insert new twitch user:");e&&(o(e),c.emit("changeStreamersChat",e))}})))},v=function(){var e=Object(a.useContext)(x),t=e.socket,n=e.admin,c=e.setAdmin,o=e.history,u=Object(a.useState)(""),l=Object(i.a)(u,2),m=l[0],d=l[1],f=Object(a.useState)(0),E=Object(i.a)(f,2),b=(E[0],E[1]),v=Object(s.h)().twitchStreamer;return t.on("handleLoginAnswer",(function(e){var t=e.success,a=e.message;t?(n||c(!0),o.push("/")):b((function(e){1===++e&&alert(a),setTimeout((function(){b(0)}),100)}))})),r.a.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"}},r.a.createElement("form",null,r.a.createElement("input",{type:"text",value:m,onChange:function(e){d(e.target.value)}}),r.a.createElement("button",{onClick:function(e){e.preventDefault(),t.emit("handleLogin",{password:m,twitchStreamer:v})},type:"submit",style:{display:"none"}})))},h=n(76),p=n.n(h),j=(n(132),function(){var e=Object(s.g)(),t=Object(s.h)().twitchStreamer;void 0===t&&(t="victorowsky_");var n=Object(a.useState)(t),c=Object(i.a)(n,2),o=c[0],u=c[1],l=Object(a.useContext)(x),m=l.admin,d=l.setCurrentVideoLink,f=l.currentVideoLink,b=l.socket,v=l.onlineUsers,h=l.setAdmin,j=l.setIsSuccess,O=l.setIsError,g=l.setErrorMessage,C=l.setSuccessMessage,w=Object(a.useState)(!1),S=Object(i.a)(w,2),y=S[0],k=S[1],N=Object(a.useRef)();Object(a.useEffect)((function(){var e;return m&&(e=setInterval((function(){b.emit("adminData",{currentRoom:o,currentSeconds:N.current.getCurrentTime()})}),3e3)),function(){clearInterval(e)}}),[m,b,o]),Object(a.useEffect)((function(){m&&b.emit("videoChange",{currentVideoLink:f,currentRoom:o})}),[f,b]),Object(a.useEffect)((function(){u(t),b.emit("adminLeave")}),[e.pathname]),Object(a.useEffect)((function(){return b.emit("joinRoom",{currentRoom:o}),function(){b.emit("leaveRoom",{currentRoom:o}),h(!1),b.emit("adminLeave")}}),[o]),Object(a.useEffect)((function(){if(!m)return b.on("videoChangeAnswer",(function(e){var t=e.currentVideoLink;d(t)})),b.on("isPlayingSocketAnswer",(function(e){var t=e.isPlaying;e.currentRoom;k(t)})),b.on("joinRoomAnswer",(function(e){var t=e.docs;d(t.currentVideoLink)})),b.on("adminDataAnswer",(function(e){var t=e.currentSeconds;if(N.current){var n=N.current.getDuration(),a=N.current.getCurrentTime();n>t?a<t+6&&a>t-6||N.current.seekTo(t,"seconds"):a<n+2-3&&a>n-2-3||N.current.seekTo(n-3,"seconds")}})),function(){b.offAny()}}),[o,m]);return b.on("adminRequestAnswer",(function(e){var t=e.success,n=e.message;t?(j(!0),C(n),h(!0)):(O(!0),g(n))})),r.a.createElement("div",{className:"videoAndChat"},r.a.createElement("div",{className:"playerAndChat"},r.a.createElement("div",{className:"player-wrapper"},r.a.createElement(p.a,{ref:N,onPlay:function(){m&&(k(!0),b.emit("isPlaying",{isPlaying:!0,currentRoom:o}))},onPause:function(){m&&(k(!1),b.emit("isPlaying",{isPlaying:!1,currentRoom:o}))},playing:y,className:"react-player",url:f,width:"100%",height:"100%",controls:!0,volume:.1})),r.a.createElement("div",{className:"twitchChat"},r.a.createElement("span",{className:"onlineUsers"},v?"".concat(v," ONLINE"):"CONNECTING"),r.a.createElement("iframe",{style:{border:"2px solid #121212"},title:"TwitchChat",id:"chat_embed",src:"https://www.twitch.tv/embed/".concat(t,"/chat?darkpopout&parent=").concat("victorowsky.github.io"),height:"100%",width:"100%"}),!m&&r.a.createElement(E,{text:"GET ADMIN",onClick:function(){b.emit("adminRequest",{currentRoom:t})},style:{borderColor:"white",color:"white"}}))))}),O=n(167),g=n(168);function C(e){return r.a.createElement(g.a,Object.assign({elevation:6,variant:"filled"},e))}var w=Object(m.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}}));function S(){var e=Object(a.useContext)(x),t=e.isSuccess,n=e.setIsSuccess,c=e.successMessage,o=w(),i=function(e,t){"clickaway"!==t&&n(!1)};return r.a.createElement("div",{className:o.root},r.a.createElement(O.a,{open:t,autoHideDuration:3e3,onClose:i},r.a.createElement(C,{onClose:i,severity:"success"},c)))}function y(e){return r.a.createElement(g.a,Object.assign({elevation:6,variant:"filled"},e))}var k=Object(m.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}}));function N(){var e=Object(a.useContext)(x),t=e.isError,n=e.setIsError,c=e.errorMessage,o=k(),i=function(e,t){"clickaway"!==t&&n(!1)};return r.a.createElement("div",{className:o.root},r.a.createElement(O.a,{open:t,autoHideDuration:3e3,onClose:i},r.a.createElement(y,{onClose:i,severity:"error"},c)))}var x=r.a.createContext(),A=l()("https://boiling-bastion-80662.herokuapp.com/"),R=function(){var e=Object(s.f)(),t=Object(a.useState)(!1),n=Object(i.a)(t,2),c=n[0],o=n[1],u=Object(a.useState)(""),l=Object(i.a)(u,2),m=l[0],d=l[1],f=Object(a.useState)(null),E=Object(i.a)(f,2),h=E[0],p=E[1],O=Object(a.useState)(),g=Object(i.a)(O,2),C=g[0],w=g[1],y=Object(a.useState)(!1),k=Object(i.a)(y,2),R=k[0],T=k[1],I=Object(a.useState)(!1),L=Object(i.a)(I,2),D=L[0],M=L[1],P=Object(a.useState)(""),V=Object(i.a)(P,2),U=V[0],H=V[1],G=Object(a.useState)(""),q=Object(i.a)(G,2),B=q[0],F=q[1];return Object(a.useEffect)((function(){fetch("https://noembed.com/embed?url=".concat(m)).then((function(e){return e.json()})).then((function(e){document.title=e.title,void 0===e.title&&(document.title="Watch Together")}))}),[m]),A.on("onlineUsers",(function(e){p(e)})),r.a.createElement(r.a.Fragment,null,r.a.createElement(x.Provider,{value:{admin:c,setAdmin:o,socket:A,currentVideoLink:m,setCurrentVideoLink:d,history:e,onlineUsers:h,twitchStreamerChat:C,setTwitchStreamerChat:w,isSuccess:R,setIsSuccess:T,isError:D,setIsError:M,successMessage:U,setSuccessMessage:H,errorMessage:B,setErrorMessage:F}},r.a.createElement("div",{className:"app"},r.a.createElement(s.c,null,r.a.createElement(s.a,{path:"/",exact:!0},r.a.createElement(j,null),r.a.createElement("div",{className:"bottomDiv"},c&&r.a.createElement(b,null))),r.a.createElement(s.a,{path:"/:twitchStreamer",exact:!0},r.a.createElement(j,null),r.a.createElement("div",{className:"bottomDiv"},c&&r.a.createElement(b,null))),r.a.createElement(s.a,{path:"/admin",exact:!0},r.a.createElement(v,null)),r.a.createElement(s.a,{path:"/:twitchStreamer/admin"},r.a.createElement(v,null))),r.a.createElement(S,null),r.a.createElement(N,null))))},T=n(31);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(T.a,null,r.a.createElement(R,null))),document.getElementById("root"))},85:function(e,t,n){e.exports=n(133)},90:function(e,t,n){}},[[85,13,14]]]);
//# sourceMappingURL=main.3961a737.chunk.js.map